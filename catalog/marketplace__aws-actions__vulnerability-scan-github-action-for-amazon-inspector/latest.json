{
  "action_id": "marketplace/aws-actions/vulnerability-scan-github-action-for-amazon-inspector",
  "version_id": "8d49604de55e",
  "source": {
    "type": "marketplace",
    "action_yml_path": "blueprints/marketplace/aws-actions/vulnerability-scan-github-action-for-amazon-inspector/action.yml",
    "origin": "github.com/aws-actions/vulnerability-scan-github-action-for-amazon-inspector",
    "publisher": "aws-actions",
    "verified": true
  },
  "definition": {
    "name": "Vulnerability Scan GitHub Action for Amazon Inspector",
    "description": "Generate SBOMs and scan for vulnerabilities in artifacts such as files, directories, containers, and more.",
    "author": "",
    "inputs": [
      {
        "name": "artifact_type",
        "required": true,
        "default": "repository",
        "description": "The artifact you would like to scan with Amazon Inspector. Valid choices are \"repository\", \"container\", \"binary\", or \"archive\"."
      },
      {
        "name": "artifact_path",
        "required": true,
        "default": "./",
        "description": "The file path to the artifact you would like to scan with Amazon Inspector. File paths are relative to the root project directory. If scanning a container image, you must provide a value that follows the docker pull convention: \"NAME[:TAG|@DIGEST]\", for example, \"alpine:latest\", or a path to an image exported as tarball using \"docker save\"."
      },
      {
        "name": "display_vulnerability_findings",
        "required": true,
        "default": "disabled",
        "description": "If set to \"enabled\", the action will display detailed vulnerability findings in the step summary page; see here for an example report: https://github.com/aws-actions/vulnerability-scan-github-action-for-amazon-inspector/actions/runs/8878213714"
      },
      {
        "name": "output_sbom_path",
        "required": false,
        "default": "./sbom_${{ github.run_id }}.json",
        "description": "The destination file path for the generated SBOM."
      },
      {
        "name": "output_inspector_scan_path",
        "required": false,
        "default": "inspector_scan_${{ github.run_id }}.json",
        "description": "The destination file path for Inspector's vulnerability scan (JSON format)."
      },
      {
        "name": "output_inspector_scan_path_csv",
        "required": false,
        "default": "inspector_scan_${{ github.run_id }}.csv",
        "description": "The destination file path for Inspector's vulnerability scan (CSV format)."
      },
      {
        "name": "output_inspector_scan_path_markdown",
        "required": false,
        "default": "inspector_scan_${{ github.run_id }}.md",
        "description": "The destination file path for Inspector's vulnerability scan (markdown format)."
      },
      {
        "name": "output_inspector_dockerfile_scan_path_csv",
        "required": false,
        "default": "inspector_dockerfile_scan_${{ github.run_id }}.csv",
        "description": "The destination file path for Inspector's Dockerfile vulnerability scan (CSV format)."
      },
      {
        "name": "output_inspector_dockerfile_scan_path_markdown",
        "required": false,
        "default": "inspector_dockerfile_scan_${{ github.run_id }}.md",
        "description": "The destination file path for Inspector's Dockerfile vulnerability scan (markdown format)."
      },
      {
        "name": "sbomgen_version",
        "required": false,
        "default": "latest",
        "description": "The inspector-sbomgen version you wish to use for SBOM generation. See here for more info: https://docs.aws.amazon.com/inspector/latest/user/sbom-generator.html"
      },
      {
        "name": "critical_threshold",
        "required": false,
        "default": 0,
        "description": "Specifies the number of critical vulnerabilities needed to set the 'vulnerability_threshold_exceeded' flag."
      },
      {
        "name": "high_threshold",
        "required": false,
        "default": 0,
        "description": "Specifies the number of high vulnerabilities needed to set the 'vulnerability_threshold_exceeded' flag."
      },
      {
        "name": "medium_threshold",
        "required": false,
        "default": 0,
        "description": "Specifies the number of medium vulnerabilities needed to set the 'vulnerability_threshold_exceeded' flag."
      },
      {
        "name": "low_threshold",
        "required": false,
        "default": 0,
        "description": "Specifies the number of low vulnerabilities needed to set the 'vulnerability_threshold_exceeded' flag."
      },
      {
        "name": "other_threshold",
        "required": false,
        "default": 0,
        "description": "Specifies the number of other vulnerabilities needed to set the 'vulnerability_threshold_exceeded' flag."
      },
      {
        "name": "scanners",
        "required": false,
        "default": "''",
        "description": "Specifies the file scanners that you would like inspector-sbomgen to execute. By default, inspector-sbomgen will try to run all file scanners that are applicable to the target artifact. If this argument is set, inspector-sbomgen will only execute the specified file scanners. Provide your input as a single string. Separate each file scanner with a comma. To view a list of available file scanners, execute 'inspector-sbomgen list-scanners'. See here for more info: https://docs.aws.amazon.com/inspector/latest/user/sbom-generator.html"
      },
      {
        "name": "skip_scanners",
        "required": false,
        "default": "''",
        "description": "Specifies a list of file scanners that should NOT be executed; this argument cannot be combined with 'scanners'. If this argument is set, inspector-sbomgen will execute all file scanners except those you specified. Provide your input as a single string. Separate each file scanner with a comma. To view a list of available file scanners, execute 'inspector-sbomgen list-scanners'. See here for more info: https://docs.aws.amazon.com/inspector/latest/user/sbom-generator.html"
      },
      {
        "name": "skip_files",
        "required": false,
        "default": "''",
        "description": "Specifies one or more files and/or directories that should NOT be inventoried. Separate each file with a comma and enclose the entire string in double quotes."
      },
      {
        "name": "timeout",
        "required": false,
        "default": 600,
        "description": "Specifies a timeout in seconds. If this timeout is exceeded, the action will gracefully conclude and present any findings discovered up to that point."
      },
      {
        "name": "platform",
        "required": false,
        "default": null,
        "description": "Specifies the OS and CPU arch of the container image you wish to scan. Valid inputs are of the form 'os/cpu/variant' for example, 'linux/amd64', 'linux/arm64/v8', etc. If no platform is specified, the system will use the same platform as the host that is performing the scan. This argument only affects container image scans. Requires inspector-sbomgen 1.5.1 or later."
      },
      {
        "name": "threshold_fixable_only",
        "required": false,
        "default": false,
        "description": "If set to true, only count vulnerabilities with a fix towards threshold exceeded condition."
      },
      {
        "name": "show_only_fixable_vulns",
        "required": false,
        "default": false,
        "description": "If set to true, this action will show only fixed vulnerabilities in the GitHub Actions step summary page. All vulnerability metadata is still retained in the raw Inspector scan files."
      }
    ],
    "outputs": [
      {
        "name": "artifact_sbom",
        "description": "The filepath to the artifact's software bill of materials."
      },
      {
        "name": "inspector_scan_results",
        "description": "The file path to the Inspector vulnerability scan findings in JSON format."
      },
      {
        "name": "inspector_scan_results_csv",
        "description": "The file path to the Inspector vulnerability scan findings in CSV format."
      },
      {
        "name": "inspector_scan_results_markdown",
        "description": "The file path to the Inspector vulnerability scan findings in markdown format."
      },
      {
        "name": "inspector_dockerile_scan_results_csv",
        "description": "The file path to the Inspector Dockerfile vulnerability scan findings in CSV format."
      },
      {
        "name": "inspector_dockerile_scan_results_markdown",
        "description": "The file path to the Inspector Dockerfile vulnerability scan findings in markdown format."
      },
      {
        "name": "vulnerability_threshold_exceeded",
        "description": "This variable is set to 1 if any vulnerability threshold was exceeded, otherwise it is 0. This variable can be used to trigger custom logic, such as failing the job if vulnerabilities were detected."
      }
    ],
    "runs": {
      "using": "docker",
      "image": "Dockerfile",
      "args": [
        "--artifact-type=${{ inputs.artifact_type }}",
        "--artifact-path=${{ inputs.artifact_path }}",
        "--display-vuln-findings=${{ inputs.display_vulnerability_findings }}",
        "--out-sbom=${{ inputs.output_sbom_path}}",
        "--out-scan=${{ inputs.output_inspector_scan_path }}",
        "--out-scan-csv=${{ inputs.output_inspector_scan_path_csv }}",
        "--out-scan-markdown=${{ inputs.output_inspector_scan_path_markdown }}",
        "--out-dockerfile-scan-csv=${{ inputs.output_inspector_dockerfile_scan_path_csv }}",
        "--out-dockerfile-scan-md=${{ inputs.output_inspector_dockerfile_scan_path_markdown }}",
        "--sbomgen-version=${{ inputs.sbomgen_version }}",
        "--thresholds",
        "${{ inputs.threshold_fixable_only == 'true' && '--threshold-fixable-only' || '--no-op' }}",
        "${{ inputs.show_only_fixable_vulns == 'true' && '--show-only-fixable-vulns'|| '--no-op' }}",
        "--platform=${{ inputs.platform || '' }}",
        "--critical=${{ inputs.critical_threshold }}",
        "--high=${{ inputs.high_threshold }}",
        "--medium=${{ inputs.medium_threshold }}",
        "--low=${{ inputs.low_threshold }}",
        "--other=${{ inputs.other_threshold }}",
        "--scanners=${{ inputs.scanners }}",
        "--skip-scanners=${{ inputs.skip_scanners }}",
        "--skip-files=${{ inputs.skip_files }}",
        "--timeout=${{ inputs.timeout }}"
      ]
    }
  },
  "annotations": {
    "categories": [
      "Security",
      "Testing",
      "Dependency management"
    ],
    "confidence": "high",
    "evidence": [
      {
        "type": "llm_categorization",
        "model": "gpt-4o-mini",
        "primary_category": "Security",
        "reasoning": "This action focuses on scanning for vulnerabilities in artifacts, which is a key aspect of security. Additionally, it generates software bill of materials (SBOMs) and can be used to manage dependencies by identifying vulnerabilities in them.",
        "tags": [
          "vulnerability scan",
          "Amazon Inspector",
          "SBOM",
          "security",
          "testing"
        ]
      }
    ]
  },
  "cache": {
    "source_hash": "8d49604de55ea8bf182b55fb7517249f9ef80fce088a6956fa5a52e210849c52",
    "taxonomy_version": "0.0.1",
    "prompt_version": "v1",
    "generated_at": "2025-12-14T22:40:52.004556Z"
  }
}
