{
  "action_id": "marketplace/appleboy/trufflehog",
  "version_id": "7ff71b49aa8d",
  "source": {
    "type": "marketplace",
    "action_yml_path": "blueprints/marketplace/appleboy/trufflehog/action.yml",
    "origin": "github.com/appleboy/trufflehog",
    "publisher": "appleboy",
    "verified": false
  },
  "definition": {
    "name": "TruffleHog OSS",
    "description": "Scan Github Actions with TruffleHog.",
    "author": "Truffle Security Co. <support@trufflesec.com>",
    "inputs": [
      {
        "name": "path",
        "required": false,
        "default": "./",
        "description": "Repository path"
      },
      {
        "name": "base",
        "required": false,
        "default": "",
        "description": "Start scanning from here (usually main branch)."
      },
      {
        "name": "head",
        "required": false,
        "default": null,
        "description": "Scan commits until here (usually dev branch)."
      },
      {
        "name": "extra_args",
        "required": false,
        "default": "",
        "description": "Extra args to be passed to the trufflehog cli."
      },
      {
        "name": "version",
        "required": false,
        "default": "latest",
        "description": "Scan with this trufflehog cli version."
      }
    ],
    "outputs": [],
    "runs": {
      "using": "composite",
      "steps": [
        {
          "shell": "bash",
          "working-directory": "${{ inputs.path }}",
          "env": {
            "BASE": "${{ inputs.base }}",
            "HEAD": "${{ inputs.head }}",
            "ARGS": "${{ inputs.extra_args }}",
            "COMMIT_IDS": "${{ toJson(github.event.commits.*.id) }}",
            "VERSION": "${{ inputs.version }}"
          },
          "run": "##########################################\n## ADVANCED USAGE                       ##\n## Scan by BASE & HEAD user inputs      ##\n## If BASE == HEAD, exit with error     ##\n##########################################\n# Check if jq is installed, if not, install it\nif ! command -v jq &> /dev/null\nthen\n  echo \"jq could not be found, installing...\"\n  apt-get -y update && apt-get install -y jq\nfi\n\ngit status >/dev/null  # make sure we are in a git repository\nif [ -n \"$BASE\" ] || [ -n \"$HEAD\" ]; then\n  if [ -n \"$BASE\" ]; then\n    base_commit=$(git rev-parse \"$BASE\" 2>/dev/null) || true\n  else\n    base_commit=\"\"\n  fi\n  if [ -n \"$HEAD\" ]; then\n    head_commit=$(git rev-parse \"$HEAD\" 2>/dev/null) || true\n  else\n    head_commit=\"\"\n  fi\n  if [ \"$base_commit\" == \"$head_commit\" ] ; then\n    echo \"::error::BASE and HEAD commits are the same. TruffleHog won't scan anything. Please see documentation (https://github.com/trufflesecurity/trufflehog#octocat-trufflehog-github-action).\"\n    exit 1\n  fi\n##########################################\n## Scan commits based on event type     ##\n##########################################\nelse\n  if [ \"${{ github.event_name }}\" == \"push\" ]; then\n    COMMIT_LENGTH=$(printenv COMMIT_IDS | jq length)\n    if [ $COMMIT_LENGTH == \"0\" ]; then\n      echo \"No commits to scan\"\n      exit 0\n    fi\n    HEAD=${{ github.event.after }}\n    if [ ${{ github.event.before }} == \"0000000000000000000000000000000000000000\" ]; then\n      BASE=\"\"\n    else\n      BASE=${{ github.event.before }}\n    fi\n  elif [ \"${{ github.event_name }}\" == \"workflow_dispatch\" ] || [ \"${{ github.event_name }}\" == \"schedule\" ]; then\n    BASE=\"\"\n    HEAD=\"\"\n  elif [ \"${{ github.event_name }}\" == \"pull_request\" ]; then\n    BASE=${{github.event.pull_request.base.sha}}\n    HEAD=${{github.event.pull_request.head.sha}}\n  fi\nfi\n##########################################\n##          Run TruffleHog              ##\n##########################################\ndocker run --rm -v .:/tmp -w /tmp \\\nghcr.io/trufflesecurity/trufflehog:${VERSION} \\\ngit file:///tmp/ \\\n--since-commit \\\n${BASE:-''} \\\n--branch \\\n${HEAD:-''} \\\n--fail \\\n--no-update \\\n--github-actions \\\n${ARGS:-''}\n"
        }
      ]
    }
  },
  "annotations": {
    "categories": [
      "Security",
      "Code quality"
    ],
    "confidence": "high",
    "evidence": [
      {
        "type": "llm_categorization",
        "model": "gpt-4o-mini",
        "primary_category": "Security",
        "reasoning": "TruffleHog is designed to scan for sensitive information in code, which falls under security. Additionally, it contributes to code quality by identifying potential vulnerabilities.",
        "tags": [
          "security",
          "code quality",
          "trufflehog",
          "github actions",
          "scanning"
        ]
      }
    ]
  },
  "cache": {
    "source_hash": "7ff71b49aa8d194e19fe69daada704b9f0d1cb857da2034ddb9584c5e99a2567",
    "taxonomy_version": "0.0.1",
    "prompt_version": "v1",
    "generated_at": "2025-12-14T22:40:52.160895Z"
  }
}
