{
  "action_id": "marketplace/pypa/cibuildwheel",
  "version_id": "bdce0e873612",
  "source": {
    "type": "marketplace",
    "action_yml_path": "blueprints/marketplace/pypa/cibuildwheel/action.yml",
    "origin": "github.com/pypa/cibuildwheel",
    "publisher": "pypa",
    "verified": false
  },
  "definition": {
    "name": "cibuildwheel",
    "description": "Installs and runs cibuildwheel on the current runner",
    "author": "",
    "inputs": [
      {
        "name": "package-dir",
        "required": false,
        "default": ".",
        "description": "Input directory, defaults to \".\""
      },
      {
        "name": "output-dir",
        "required": false,
        "default": "wheelhouse",
        "description": "Folder to place the outputs in, defaults to \"wheelhouse\""
      },
      {
        "name": "config-file",
        "required": false,
        "default": "",
        "description": "File containing the config, defaults to {package}/pyproject.toml"
      },
      {
        "name": "only",
        "required": false,
        "default": "",
        "description": "Build a specific wheel only. No need for arch/platform if this is set"
      },
      {
        "name": "extras",
        "required": false,
        "default": "",
        "description": "Comma-separated list of extras to install"
      }
    ],
    "outputs": [],
    "runs": {
      "using": "composite",
      "steps": [
        {
          "uses": "actions/setup-python@v6",
          "id": "python",
          "with": {
            "python-version": "3.11 - 3.13",
            "update-environment": false
          }
        },
        {
          "id": "cibw",
          "run": "# Install cibuildwheel\n\"${{ steps.python.outputs.python-path }}\" -u << \"EOF\"\nimport os\nimport shutil\nimport sys\nimport venv\n\nfrom pathlib import Path\nfrom subprocess import run\n\nEXTRAS = set(e.strip() for e in \"${{ inputs.extras }}\".split(\",\") if e.strip())\nif sys.platform == \"linux\":\n    EXTRAS.discard(\"uv\")\n\n\nclass EnvBuilder(venv.EnvBuilder):\n    def __init__(self):\n        super().__init__()\n\n    def setup_scripts(self, context):\n        pass\n\n    def post_setup(self, context):\n        super().post_setup(context)\n        self.bin_path = Path(context.env_exe).parent\n        install_spec = r\"${{ github.action_path }}\"\n        if EXTRAS:\n            install_spec += f\"[{','.join(sorted(EXTRAS))}]\"\n        run([sys.executable, \"-m\", \"pip\", \"--python\", context.env_exe, \"install\", install_spec], check=True)\n\n\nprint(\"::group::Install cibuildwheel\")\nvenv_path = Path(r\"${{ runner.temp }}\") / \"cibw\"\nif venv_path.exists():\n    shutil.rmtree(venv_path)\nbuilder = EnvBuilder()\nbuilder.create(venv_path)\nexposed_binaries = {\"cibuildwheel\"}\nif \"uv\" in EXTRAS:\n    exposed_binaries.add(\"uv\")\nclean_bin_path = builder.bin_path.parent / f\"{builder.bin_path.name}.clean\"\nclean_bin_path.mkdir()\nfor path in list(builder.bin_path.iterdir()):\n    if path.stem in exposed_binaries:\n        try:\n            os.symlink(path, clean_bin_path / path.name)\n        except OSError:\n            import shutil\n\n            shutil.copy2(path, clean_bin_path / path.name)\nfull_path = f\"{clean_bin_path}{os.pathsep}{os.environ['PATH']}\"\nwith open(os.environ[\"GITHUB_OUTPUT\"], \"at\") as f:\n    f.write(f\"updated-path={full_path}\\n\")\nprint(\"::endgroup::\")\nEOF\n",
          "shell": "bash"
        },
        {
          "run": "cibuildwheel \"${{ inputs.package-dir }}\" ${{ inputs.output-dir != ''  && format('--output-dir \"{0}\"', inputs.output-dir) || ''}} ${{ inputs.config-file != '' && format('--config-file \"{0}\"', inputs.config-file) || ''}} ${{ inputs.only != ''        && format('--only \"{0}\"', inputs.only) || ''}} 2>&1\n",
          "env": {
            "PATH": "${{ steps.cibw.outputs.updated-path }}"
          },
          "shell": "bash",
          "if": "runner.os != 'Windows'"
        },
        {
          "run": "cibuildwheel \"${{ inputs.package-dir }}\" ${{ inputs.output-dir != ''  && format('--output-dir \"{0}\"', inputs.output-dir) || ''}} ${{ inputs.config-file != '' && format('--config-file \"{0}\"', inputs.config-file) || ''}} ${{ inputs.only != ''        && format('--only \"{0}\"', inputs.only) || ''}}\n",
          "env": {
            "PATH": "${{ steps.cibw.outputs.updated-path }}"
          },
          "shell": "pwsh",
          "if": "runner.os == 'Windows'"
        }
      ]
    }
  },
  "annotations": {
    "categories": [],
    "confidence": null,
    "evidence": []
  },
  "cache": {
    "source_hash": "bdce0e8736123076ee9953d5121ea19c490fac8e67d064a8bb1b96cb52412fb7",
    "taxonomy_version": "0.0.1",
    "prompt_version": "v1",
    "generated_at": "2025-12-14T22:40:51.432177Z"
  }
}
